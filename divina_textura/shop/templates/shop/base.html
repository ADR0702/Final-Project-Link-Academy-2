<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}Shop{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Fonturi mai elegante -->
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600&family=Montserrat:wght@300;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

    <style>
        :root {
            --main-color: #b08d57; /* gold premium */
            --hover-color: #111;
            --bg-color: #fdfdfd;
        }

        body, html {
            margin: 0;
            padding: 0;
            font-family: 'Montserrat', sans-serif;
            background-color: var(--bg-color);
            color: var(--hover-color);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        main {
            padding: 40px 20px;
            flex: 1; /* Ã®mpinge footerul jos */
        }

        /* Header fix premium */
        header {
            position: sticky;
            top: 0;
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px 40px;
            background: rgba(255,255,255,0.9);
            backdrop-filter: blur(8px);
            border-bottom: 1px solid rgba(176,141,87,0.2);
        }

        /* Logo */
        .logo-header {
            width: 180px;
            height: auto;
            transition: transform 0.3s ease;
        }
        .logo-header:hover {
            transform: scale(1.05);
        }

        /* Meniu */
        .menu-container {
            position: relative;
            margin-right: 20px;
        }

        .menu-icon {
            font-size: 1.8rem;
            cursor: pointer;
            background: none;
            border: none;
            color: var(--main-color);
            transition: transform 0.3s ease, color 0.3s ease;
        }
        .menu-icon:hover {
            transform: rotate(90deg);
            color: var(--hover-color);
        }

        .categories-menu {
            opacity: 0;
            transform: translateY(15px);
            pointer-events: none;
            transition: all 0.3s ease;
            position: absolute;
            top: 120%;
            left: 0;
            background: white;
            padding: 10px 0;
            border-radius: 8px;
            box-shadow: 0 15px 30px rgba(0,0,0,0.1);
            min-width: 220px;
            list-style: none;
        }
        .categories-menu.visible {
            opacity: 1;
            transform: translateY(0);
            pointer-events: auto;
        }

        .category-item > a {
            display: block;
            padding: 12px 20px;
            text-decoration: none;
            color: var(--hover-color);
            font-weight: 500;
            transition: all 0.3s ease;
        }
        .category-item > a:hover {
            background: var(--main-color);
            color: white;
        }
        .subcategory-menu {
            display: none;
            position: absolute;
            top: 0;
            left: 100%;
            background: white;
            border-radius: 8px;
            min-width: 200px;
            box-shadow: 0 15px 30px rgba(0,0,0,0.1);
            list-style: none;
            padding: 10px 0;
        }
        .category-item:hover .subcategory-menu {
            display: block;
        }
        .subcategory-menu a {
            padding: 10px 18px;
            display: block;
            text-decoration: none;
            color: var(--hover-color);
            font-size: 0.95rem;
            transition: background 0.3s ease;
        }
        .subcategory-menu a:hover {
            background: var(--main-color);
            color: white;
        }

        /* Search */
        .search-container {
            flex: 1;
            display: flex;
            justify-content: center;
        }
        .search-box {
            display: flex;
            align-items: center;
            border: 1px solid var(--main-color);
            border-radius: 30px;
            padding: 5px 15px;
            background: white;
            max-width: 350px;
            width: 100%;
        }
        .search-box input {
            border: none;
            outline: none;
            background: transparent;
            font-size: 0.95rem;
            flex: 1;
            color: var(--hover-color);
        }
        .search-box i {
            color: var(--main-color);
            font-size: 1rem;
        }

        /* Dreapta header */
        .header-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        .header-right a, .header-right button {
            text-decoration: none;
            color: var(--hover-color);
            font-size: 0.95rem;
            font-weight: 500;
            background: none;
            border: none;
            cursor: pointer;
            transition: color 0.3s ease;
        }
        .header-right a:hover, .header-right button:hover {
            color: var(--main-color);
        }

        /* Shopping bag hover */
        .shopping-bag-hover {
            display: none;
            position: absolute;
            top: 120%;
            right: 0;
            width: 320px;
            background: white;
            color: var(--hover-color);
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            font-size: 0.9rem;
        }
        .shopping-bag-hover ul {
            list-style: none;
            padding: 0;
            margin: 0 0 10px;
            max-height: 180px;
            overflow-y: auto;
        }
        .shopping-bag-hover ul li {
            border-bottom: 1px solid #eee;
            padding: 6px 0;
        }
        .hover-buttons {
            display: flex;
            gap: 10px;
        }
        .hover-buttons a {
            flex: 1;
            text-align: center;
            padding: 8px 0;
            background: var(--main-color);
            color: white;
            border-radius: 5px;
            font-weight: 600;
            text-decoration: none;
            transition: background 0.3s ease;
        }
        .hover-buttons a:hover {
            background: #8d6b3f;
        }

        /* Footer */
        footer {
            background: #f3f3f3;
            padding: 40px 20px;
            border-top: 1px solid rgba(0,0,0,0.1);
        }
        .footer-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 30px;
            max-width: 1200px;
            margin: auto;
        }
        .footer-col h4 {
            margin-bottom: 15px;
            color: var(--main-color);
            font-weight: 600;
        }
        .footer-col p, .footer-col a {
            font-size: 0.95rem;
            color: var(--hover-color);
            text-decoration: none;
            display: block;
            margin-bottom: 8px;
            transition: color 0.3s ease;
        }
        .footer-col a:hover {
            color: var(--main-color);
        }
    </style>
</head>
<body>

<header>
    <div class="menu-container">
        <button class="menu-icon" id="hamburger"><i class="fas fa-bars"></i></button>
        <ul class="categories-menu" id="categoryMenu">
            {% for cat in categories %}
                <li class="category-item">
                    <a href="{% url 'category_detail_url' slug=cat.slug %}">{{ cat.name }}</a>
                    {% if cat.subcategories.count %}
                        <ul class="subcategory-menu">
                            {% for sub in cat.subcategories.all %}
                                <li><a href="{% url 'subcategory_detail_url' parent_slug=cat.slug sub_slug=sub.slug %}">{{ sub.name }}</a></li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                </li>
            {% endfor %}
        </ul>
    </div>

    <a href="{% url 'home_url' %}"><img src="https://i.postimg.cc/wvdJjnBK/Divina-Textura-Red.png" alt="Logo" class="logo-header"></a>

    <div class="search-container">
        <form class="search-box" method="get" action="{% url 'product_search' %}">
            <input type="text" name="q" placeholder="Search product">
            <button type="submit" style="background:none; border:none;">
                <i class="fas fa-search"></i>
            </button>
        </form>
    </div>

    <div class="header-right">
        {% if user.is_authenticated %}
            <a href="#"><i class="fas fa-user"></i> {{ user.username }}</a>
            <form method="post" action="{% url 'logout' %}" style="display:inline;">
                {% csrf_token %}
                <button type="submit"><i class="fas fa-sign-out-alt"></i> Logout</button>
            </form>
        {% else %}
            <a href="{% url 'login' %}?next={{ request.path }}"><i class="fas fa-sign-in-alt"></i> Login</a>
            <a href="{% url 'register' %}"><i class="fas fa-user-plus"></i> Register</a>
        {% endif %}

        {% with cart.items.count as item_count %}
            {% if user.is_authenticated %}
                <div style="position: relative;">
                    <a href="{% url 'cart_url' %}" id="shoppingBagLink" onmouseover="showBagHover()" onmouseout="hideBagHover()">
                        <i class="fas fa-shopping-bag"></i> ({{ item_count }})
                    </a>
                    <div id="shoppingBagHover" class="shopping-bag-hover" onmouseover="showBagHover()" onmouseout="hideBagHover()">
                        {% if cart.items.count %}
                            <strong>Products in bag:</strong>
                            <ul>
                                {% for item in cart.items.all %}
                                    <li>{{ item.product.name }} x {{ item.quantity }}</li>
                                {% endfor %}
                            </ul>
                            <div class="hover-buttons">
                                <a href="{% url 'checkout_url' %}">Finish Order</a>
                                <a href="{% url 'cart_url' %}">Shopping Bag</a>
                            </div>
                        {% else %}
                            <p>The Shopping Bag is Empty.</p>
                        {% endif %}
                    </div>
                </div>
            {% else %}
                <a href="{% url 'login' %}?next=/"><i class="fas fa-shopping-bag"></i> ({{ item_count }})</a>
            {% endif %}
        {% endwith %}
    </div>
</header>

<main>
    {% block content %}{% endblock %}
</main>

<footer>
    <div class="footer-container">
        <div class="footer-col">
            <h4>About Us</h4>
            <p>Divina Textura is a distinguished boutique dedicated to the sacred mission of bringing Scripture to life through elegant apparel and unique designs. Each piece is crafted with reverence and meticulous care, embedding divine messages and timeless truths into every fiber. Our garments are not simply attire, but expressions of faithâmeant to inspire, uplift, and serve as a constant reminder of the sacred light that guides us. At Divina Textura, we honor God through fashion, creating wearable blessings that connect the soul with higher purpose and grace</p>
        </div>
        <div class="footer-col">
            <h4>Client Services</h4>
            <p>Email: <a href="mailto:contact@divinatextura.com">contact@divinatextura.com</a></p>
            <p>Tel: <a href="tel:+40751486784">+40 751 486 784</a></p>
        </div>
        <div class="footer-col">
            <h4>Delivery & Returns</h4>
            <a href="{% url 'delivery_returns' %}">Policy</a>
        </div>
        <div class="footer-col">
            <h4>Legal Terms</h4>
            <a href="{% url 'gdpr' %}">GDPR</a>
            <a href="{% url 'terms_conditions' %}">Terms & Conditions</a>
        </div>
    </div>
</footer>

<script>
    let hoverTimeout;
    function showBagHover() {
        clearTimeout(hoverTimeout);
        document.getElementById('shoppingBagHover').style.display = 'block';
    }
    function hideBagHover() {
        hoverTimeout = setTimeout(() => {
            document.getElementById('shoppingBagHover').style.display = 'none';
        }, 200);
    }
    document.addEventListener('DOMContentLoaded', () => {
        const hamburger = document.getElementById('hamburger');
        const menu = document.getElementById('categoryMenu');
        const menuContainer = document.querySelector('.menu-container');
        hamburger.addEventListener('click', (e) => {
            e.stopPropagation();
            menu.classList.toggle('visible');
        });
        document.addEventListener('click', (e) => {
            if (!menuContainer.contains(e.target)) {
                menu.classList.remove('visible');
            }
        });
    });
</script>

</body>
</html>
